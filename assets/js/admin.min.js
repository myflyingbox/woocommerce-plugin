jQuery(function(n){({states:null,init:function(){n("#myflyingbox-order-shipping").on("click","button.add-shipment",this.add_shipment).on("click","div.mfb-available-offers button.book-offer",this.book_offer).on("click","div.display_recipient_address a.edit_recipient_address",this.load_recipient_form).on("click","div.display_shipper_address a.edit_shipper_address",this.load_shipper_form).on("click","div.parcel-data a.edit_parcel",this.load_parcel_form).on("click","div.parcel-data a.delete_parcel",this.delete_parcel).on("click","div.parcel-data button.new_parcel",this.load_parcel_form).on("click","div.recipient_form_container button.cancel_recipient_form",this.hide_recipient_form).on("click","div.shipper_form_container button.cancel_shipper_form",this.hide_shipper_form).on("click","div.parcel div.parcel-form button.cancel_parcel_form",this.hide_parcel_form).on("click","div.recipient_form_container button.submit_recipient_form",this.submit_recipient_form).on("click","div.shipper_form_container button.submit_shipper_form",this.submit_shipper_form).on("click","div.mfb-booked-offer button.download-labels",this.download_labels).on("click","div.parcel div.parcel-form button.submit_parcel_form",this.submit_parcel_form).on("change","div.mfb-available-offers select.offer-selector",this.update_selected_offer).on("click","a.delete-shipment",this.delete_shipment).on("click","button.add-return-shipment",this.add_return_shipment),n("#myflyingbox-bulk-shipments").on("click","div.mfb-available-offers button.book-offer",this.book_offer).on("click","div.mfb-booked-offer button.download-labels",this.download_labels).on("change","div.mfb-available-offers select.offer-selector",this.update_selected_offer)},add_shipment:function(){var e={action:"mfb_create_shipment",order_id:mfb_js_resources.post_id};return n.ajax({url:mfb_js_resources.ajax_url,data:e,type:"POST",success:function(e){window.location.reload()}}),!1},book_offer:function(){var e=n(this).closest("div.mfb-available-offers").find("select.offer-selector option:selected").data("offer_id"),i=n(this).closest("div.mfb-available-offers").find("select.pickup-date-selector"),t=n(this).closest("div.mfb-available-offers").find("select.delivery-location-selector"),s=n(this).closest("div.mfb-available-offers").find("input#mfb_ad_valorem_insurance"),a="",r="",o="0";n(this).find(".spinner").addClass("is-active"),i&&(a=i.val()),t&&(r=t.val()),s.is(":checked")&&(o="1");o={action:"mfb_book_offer",offer_id:e,pickup_date:a,relay_code:r,insurance:o,shipment_id:n(this).closest("tr").data("shipment_id")};return n.ajax({url:mfb_js_resources.ajax_url,data:o,type:"POST",dataType:"json",success:function(e){!0===e.success?window.location.reload():alert(e.data.message)}}),!1},update_selected_offer:function(){var e={action:"mfb_update_selected_offer",offer_id:n(this).find("option:selected").data("offer_id"),shipment_id:n(this).closest("tr").data("shipment_id")};return n.ajax({url:mfb_js_resources.ajax_url,data:e,type:"POST",dataType:"json",success:function(e){window.location.reload()}}),!1},delete_shipment:function(){var e={action:"mfb_delete_shipment",shipment_id:n(this).closest("tr").data("shipment_id")};return n.ajax({url:mfb_js_resources.ajax_url,data:e,type:"POST",success:function(e){window.location.reload()}}),!1},add_return_shipment:function(){var e={action:"mfb_create_return_shipment",shipment_id:n(this).closest("tr").data("shipment_id")};return n.ajax({url:mfb_js_resources.ajax_url,data:e,type:"POST",success:function(e){window.location.reload()}}),!1},load_recipient_form:function(e){e.preventDefault(),n(this).closest("div.display_recipient_address").hide(),n(this).closest("td").find("div.recipient_form_container").show()},load_shipper_form:function(e){e.preventDefault(),n(this).closest("div.display_shipper_address").hide(),n(this).closest("td").find("div.shipper_form_container").show()},load_parcel_form:function(e){e.preventDefault(),n(this).closest("div.parcel-data").hide(),n(this).closest("div.parcel").find("div.parcel-form").show()},hide_recipient_form:function(e){e.preventDefault(),n(this).closest("td").find("div.recipient_form_container").hide(),n(this).closest("td").find("div.display_recipient_address").show()},hide_shipper_form:function(e){e.preventDefault(),n(this).closest("td").find("div.shipper_form_container").hide(),n(this).closest("td").find("div.display_shipper_address").show()},hide_parcel_form:function(e){e.preventDefault(),n(this).closest("div.parcel").find("div.parcel-form").hide(),n(this).closest("div.parcel").find("div.parcel-data").show()},submit_recipient_form:function(e){e.preventDefault();e=n(this).closest("tr").data("shipment_id");return n(this).find(".spinner").addClass("is-active"),n.ajax({url:mfb_js_resources.ajax_url,data:n(this).closest("div.recipient_form_container").find("input, textarea, select").serialize()+"&action=mfb_update_recipient&shipment_id="+e,type:"POST",success:function(e){window.location.reload()}}),!1},submit_shipper_form:function(e){e.preventDefault();e=n(this).closest("tr").data("shipment_id");return n(this).find(".spinner").addClass("is-active"),n.ajax({url:mfb_js_resources.ajax_url,data:n(this).closest("div.shipper_form_container").find("input, textarea, select").serialize()+"&action=mfb_update_shipper&shipment_id="+e,type:"POST",success:function(e){window.location.reload()}}),!1},submit_parcel_form:function(e){e.preventDefault();var i=n(this).closest("tr").data("shipment_id"),e=n(this).closest("div.parcel").data("parcel_index");return n(this).find(".spinner").addClass("is-active"),n.ajax({url:mfb_js_resources.ajax_url,data:n(this).closest("div.parcel-form").find("input, select").serialize()+"&action=mfb_update_parcel&shipment_id="+i+"&parcel_index="+e,type:"POST",success:function(e){window.location.reload()}}),!1},delete_parcel:function(e){e.preventDefault();var i=n(this).closest("tr").data("shipment_id"),e=n(this).closest("div.parcel").data("parcel_index");return n(this).closest("div.parcel").find(".spinner.delete-parcel-spinner").addClass("is-active"),n.ajax({url:mfb_js_resources.ajax_url,data:"action=mfb_delete_parcel&shipment_id="+i+"&parcel_index="+e,type:"POST",success:function(e){window.location.reload()}}),!1},download_labels:function(){var e=n(this).closest("tr").data("shipment_id");return window.open(mfb_js_resources.labels_url+"&shipment_id="+e),!1}}).init()});