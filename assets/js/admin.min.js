jQuery(function(a){var b={states:null,init:function(){a("#myflyingbox-order-shipping").on("click","button.add-shipment",this.add_shipment).on("click","div.mfb-available-offers button.book-offer",this.book_offer).on("click","div.display_recipient_address a.edit_recipient_address",this.load_recipient_form).on("click","div.display_shipper_address a.edit_shipper_address",this.load_shipper_form).on("click","div.parcel-data a.edit_parcel",this.load_parcel_form).on("click","div.recipient_form_container button.cancel_recipient_form",this.hide_recipient_form).on("click","div.shipper_form_container button.cancel_shipper_form",this.hide_shipper_form).on("click","div.parcel div.parcel-form button.cancel_parcel_form",this.hide_parcel_form).on("click","div.recipient_form_container button.submit_recipient_form",this.submit_recipient_form).on("click","div.shipper_form_container button.submit_shipper_form",this.submit_shipper_form).on("click","div.mfb-booked-offer button.download-labels",this.download_labels).on("click","div.parcel div.parcel-form button.submit_parcel_form",this.submit_parcel_form).on("change","div.mfb-available-offers select.offer-selector",this.update_selected_offer).on("click","a.delete-shipment",this.delete_shipment)},add_shipment:function(){var b={action:"mfb_create_shipment",order_id:woocommerce_admin_meta_boxes.post_id};return a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:b,type:"POST",success:function(a){window.location.reload()}}),!1},book_offer:function(){var b=a(this).closest("div.mfb-available-offers").find("select.offer-selector option:selected").data("offer_id"),c=a(this).closest("div.mfb-available-offers").find("select.pickup-date-selector"),d=a(this).closest("div.mfb-available-offers").find("select.delivery-location-selector"),e="",f="";c&&(e=c.val()),d&&(f=d.val());var g={action:"mfb_book_offer",offer_id:b,pickup_date:e,relay_code:f,shipment_id:a(this).closest("tr").data("shipment_id")};return a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:g,type:"POST",dataType:"json",success:function(a){!0===a.success?window.location.reload():alert(a.data.message)}}),!1},update_selected_offer:function(){var b=a(this).find("option:selected").data("offer_id"),c={action:"mfb_update_selected_offer",offer_id:b,shipment_id:a(this).closest("tr").data("shipment_id")};return console.log(c),a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:c,type:"POST",dataType:"json",success:function(a){window.location.reload()}}),!1},delete_shipment:function(){var b={action:"mfb_delete_shipment",shipment_id:a(this).closest("tr").data("shipment_id")};return a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:b,type:"POST",success:function(a){window.location.reload()}}),!1},load_recipient_form:function(b){b.preventDefault(),a(this).closest("div.display_recipient_address").hide(),a(this).closest("td").find("div.recipient_form_container").show()},load_shipper_form:function(b){b.preventDefault(),a(this).closest("div.display_shipper_address").hide(),a(this).closest("td").find("div.shipper_form_container").show()},load_parcel_form:function(b){b.preventDefault(),a(this).closest("div.parcel-data").hide(),a(this).closest("div.parcel").find("div.parcel-form").show()},hide_recipient_form:function(b){b.preventDefault(),a(this).closest("td").find("div.recipient_form_container").hide(),a(this).closest("td").find("div.display_recipient_address").show()},hide_shipper_form:function(b){b.preventDefault(),a(this).closest("td").find("div.shipper_form_container").hide(),a(this).closest("td").find("div.display_shipper_address").show()},hide_parcel_form:function(b){b.preventDefault(),a(this).closest("div.parcel").find("div.parcel-form").hide(),a(this).closest("div.parcel").find("div.parcel-data").show()},submit_recipient_form:function(b){b.preventDefault();var c="mfb_update_recipient",d=a(this).closest("tr").data("shipment_id"),e=a(this).closest("form");return a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:e.serialize()+"&action="+c+"&shipment_id="+d,type:"POST",success:function(a){window.location.reload()}}),!1},submit_shipper_form:function(b){b.preventDefault();var c="mfb_update_shipper",d=a(this).closest("tr").data("shipment_id"),e=a(this).closest("form");return a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:e.serialize()+"&action="+c+"&shipment_id="+d,type:"POST",success:function(a){window.location.reload()}}),!1},submit_parcel_form:function(b){b.preventDefault();var c="mfb_update_parcel",d=a(this).closest("tr").data("shipment_id"),e=a(this).closest("div.parcel").data("parcel_index"),f=a(this).closest("form");return a.ajax({url:woocommerce_admin_meta_boxes.ajax_url,data:f.serialize()+"&action="+c+"&shipment_id="+d+"&parcel_index="+e,type:"POST",success:function(a){window.location.reload()}}),!1},download_labels:function(){var b=a(this).closest("tr").data("shipment_id");return window.open(plugin_url+"/my-flying-box/direct/download_labels.php?shipment_id="+b),!1}};b.init()});